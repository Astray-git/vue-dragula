/*!
 * vue-dragula v1.0.4
 * (c) 2016 Yichang Liu
 * Released under the MIT License.
 */
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("dragula")):"function"==typeof define&&define.amd?define(["dragula"],n):e.vueDragula=n(e.dragula)}(this,function(e){"use strict";function n(n){var i=new o(n),t="globalBag",a=void 0;n.dragula={options:i.setOptions.bind(i),eventBus:i.eventBus},n.directive("dragula",{params:["bag"],bind:function(){var n=this.el,o=this.params.bag;void 0!==o&&0!==o.length&&(t=o);var r=i.find(t);return r?(a=r.drake,void a.containers.push(n)):(a=e({containers:[n]}),i.add(t,a),void i.handleModels(t,a))},update:function(e,n){if(e)if(a.models){var i=n?a.models.indexOf(n):-1;i>=0?a.models.splice(i,1,e):a.models.push(e)}else a.models=[e]},unbind:function(){var e=this.el,n="globalBag",t=this.params.bag;void 0!==t&&0!==t.length&&(n=t);var a=i.find(n).drake;if(a){var o=a.containers.indexOf(e);o>-1&&a.containers.splice(o,1),0===a.containers.length&&i.destroy(n)}}})}function i(e){arguments.length<=1||void 0===arguments[1]?{}:arguments[1];i.installed&&console.warn("[vue-dragula] already installed."),n(e)}e="default"in e?e.default:e;var t=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},a=function(){function e(e,n){for(var i=0;i<n.length;i++){var t=n[i];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(n,i,t){return i&&e(n.prototype,i),t&&e(n,t),n}}();if(!e)throw new Error("[vue-dragula] cannot locate dragula.");var o=function(){function n(e){t(this,n),this.bags=[],this.eventBus=new e,this.events=["cancel","cloned","drag","dragend","drop","out","over","remove","shadow","dropModel","removeModel"]}return a(n,[{key:"add",value:function(e,n){var i=this.find(e);if(i)throw new Error('Bag named: "'+e+'" already exists.');return i={name:e,drake:n},this.bags.push(i),n.models&&this.handleModels(e,n),i.initEvents||this.setupEvents(i),i}},{key:"find",value:function(e){for(var n=this.bags,i=0;i<n.length;i++)if(n[i].name===e)return n[i]}},{key:"handleModels",value:function(e,n){var i=this;if(!n.registered){var t=void 0,a=void 0,o=void 0,r=void 0;n.on("remove",function(t,o){n.models&&(r=n.models[n.containers.indexOf(o)],r.splice(a,1),i.eventBus.$emit("removeModel",[e,t,o]))}),n.on("drag",function(e,n){t=e,a=i.domIndexOf(e,n)}),n.on("drop",function(d,s,l){if(n.models&&s){if(o=i.domIndexOf(d,s),r=n.models[n.containers.indexOf(l)],s===l)r.splice(o,0,r.splice(a,1)[0]);else{var u=t===d,f=n.models[n.containers.indexOf(s)],c=u?r[a]:JSON.parse(JSON.stringify(r[a]));u&&r.splice(a,1),f.splice(o,0,c)}i.eventBus.$emit("dropModel",[e,d,s,l])}}),n.registered=!0}}},{key:"destroy",value:function(e){var n=this.find(e);if(n){var i=this.bags.indexOf(n);this.bags.splice(i,1),n.drake.destroy()}}},{key:"setOptions",value:function(n,i){var t=this.add(n,e(i));this.handleModels(n,t.drake)}},{key:"setupEvents",value:function(e){e.initEvents=!0;var n=this,i=function(i){function t(){var t=Array.prototype.slice.call(arguments);n.eventBus.$emit(i,[e.name].concat(t))}e.drake.on(i,t)};this.events.forEach(i)}},{key:"domIndexOf",value:function(e,n){return Array.prototype.indexOf.call(n.children,e)}}]),n}();if(!e)throw new Error("[vue-dragula] cannot locate dragula.");return i.version="1.0.0","function"==typeof define&&define.amd?define([],function(){}):window.Vue&&window.Vue.use(i),i});